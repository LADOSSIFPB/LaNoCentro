<md-content flex layout-padding>
  <md-card flex layout-padding>

    <md-card-header>
      <md-card-avatar>
        <ng-md-icon icon="shopping_cart" size="42"></ng-md-icon>
      </md-card-avatar>

      <md-card-header-text>
        <span class="md-title">Adicionar Empresa</span>
        <span class="md-subhead">Clique nesse botão para Salvar as informações da Empresa.</span>
      </md-card-header-text>

      <!-- Salvar alterações -->
      <md-card-icon-actions>
        <md-button ng-disabled="editarEmpresaForm.$invalid" aria-label="Excluir o registro da Empresa." ng-click="excluir()">
          <md-tooltip md-direction="bottom">Excluir Empresa</md-tooltip>
          <ng-md-icon icon="delete" size="42"></ng-md-icon>
        </md-button>
        <md-button ng-disabled="editarEmpresaForm.$invalid" aria-label="Salvar os dados da Empresa." ng-click="atualizar()">
          <md-tooltip md-direction="bottom">Salvar Empresa</md-tooltip>
          <ng-md-icon icon="save" size="42"></ng-md-icon>
        </md-button>
      </md-card-icon-actions>
    </md-card-header>

    <md-card-content layout="column">
      <form name="editarEmpresaForm" layout="column" novalidate>

        <fieldset>
          <legend>Dados Básicos</legend>
          <!-- Nome da empresa -->
          <md-input-container class="md-icon-float md-block">
            <label>Nome</label>
            <input ng-model="empresa.nome" name="nome" type="text" required>
            <div ng-messages="editarEmpresaForm.nome.$error" role="alert">
              <div ng-messages-include="messages.html"></div>
            </div>
          </md-input-container>

          <div layout="row" flex>
            <!-- Telefone -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Telefone</label>
              <input ng-model="empresa.telefone" name="telefone" type="text"
                ui-br-phone-number-mask="areaCode" required>
              <div ng-messages="editarEmpresaForm.telefone.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>

            <!-- Email -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>E-mail</label>
              <input ng-model="empresa.email" name="email" type="email" ng-pattern="/^.+@.+\..+$/" required>
              <div ng-messages="editarEmpresaForm.email.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>
          </div>

          <!-- Natureza -->
          <div layout="row" flex>
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Natureza</label>
              <md-select ng-model="empresa.natureza.id" name="natureza" aria-label="Selecione a Natureza da Empresa">
                <md-option ng-repeat="natureza in naturezas" value="{{natureza.id}}">
                  {{natureza.tipo}}
                </md-option>
              </md-select>
              <div ng-messages="editarEmpresaForm.empresa.$error">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>

            <!-- Atividade -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Atividade</label>
              <md-select ng-model="empresa.atividade.id" name="atividade" aria-label="Selecione a Atividade Comercial da Empresa">
                <md-option ng-repeat="atividade in atividades" value="{{atividade.id}}">
                  {{atividade.nome}}
                </md-option>
              </md-select>
              <div ng-messages="cadastrarEmpresaForm.empresa.$error">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>
          </div>

          <!-- Delivery -->
          <md-input-container class="md-block">
            <md-checkbox ng-model="empresa.isDelivery" aria-label="Faz entrega?">
              A empresa realiza entrega de produtos por Delivery: <b>{{empresa.isDelivery| yesNo}}</b>.
            </md-checkbox>
          </md-input-container>
        </fieldset>

        <fieldset>
          <legend>Endereço</legend>
          <!-- Endereço -->
          <!-- Logradouro -->
          <md-input-container class="md-icon-float md-block">
            <label>Logradouro</label>
            <input ng-model="endereco.logradouro" name="logradouro" type="text" required>
            <div ng-messages="editarEmpresaForm.logradouro.$error" role="alert">
              <div ng-messages-include="messages.html"></div>
            </div>
          </md-input-container>

          <div layout="row" flex>
            <!-- Estado -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Estado</label>
              <md-select ng-model="endereco.estado.id" name="estado" aria-label="Selecione o Estado da Empresa">
                <md-option ng-repeat="estado in estados" value="{{estado.id}}">
                  {{estado.nome}}
                </md-option>
              </md-select>
              <div ng-messages="editarEmpresaForm.estado.$error">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>

            <!-- Cidade -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Cidade</label>
              <md-select ng-model="endereco.cidade.id" name="cidade" aria-label="Selecione a Cidade da Empresa">
                <md-option ng-repeat="cidade in cidades" value="{{cidade.id}}">
                  {{cidade.nome}}
                </md-option>
              </md-select>
              <div ng-messages="editarEmpresaForm.cidade.$error">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>
          </div>

          <div layout="row" flex>
            <!-- Número -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Número</label>
              <input ng-model="endereco.numero" name="numero" type="text" required>
              <div ng-messages="editarEmpresaForm.numero.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>

            <!-- Complemento -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Complemento</label>
              <input ng-model="endereco.complemento" name="complemento" type="text">
              <div ng-messages="editarEmpresaForm.complemento.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>
          </div>

          <div layout="row" flex>
            <!-- Ponto de referência -->
            <md-input-container class="md-icon-float md-block" flex="70">
              <label>Ponto de Referência</label>
              <input ng-model="endereco.ponto_referencia" name="ponto_referencia" type="text">
              <div ng-messages="editarEmpresaForm.ponto_referencia.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>

            <!-- Cep -->
            <md-input-container class="md-icon-float md-block" flex="30">
              <label>Cep</label>
              <input ng-model="endereco.cep" name="cep" type="text" ui-br-cep-mask required>
              <div ng-messages="editarEmpresaForm.cep.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>
          </div>
        </fieldset>

        <fieldset>
          <legend>Mapas</legend>
          <div layout="row" flex>
            <!-- Latitude -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Latitude</label>
              <input ng-model="empresa.latitude" name="latitude" type="text">
              <div ng-messages="cadastrarEmpresaForm.latitude.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>

            <!-- Longitude -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Longitude</label>
              <input ng-model="empresa.longitude" name="longitude" type="text">
              <div ng-messages="cadastrarEmpresaForm.longitude.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>
          </div>

          <!-- Tempo Real -->
          <md-input-container class="md-block">
              <md-checkbox ng-model="empresa.isTempoRealMaps" aria-label="Possui monitoramento em Tempo Real de pessoas?">
                  A empresa possui monitoramento em Tempo Real de pessoas no GoogleMaps: <b>{{empresa.isTempoRealMaps| yesNo}}</b>.
              </md-checkbox>
          </md-input-container>
        </fieldset>

        <fieldset>
          <legend>Redes Sociais</legend>
          <div layout="row" flex>
            <!-- Instagram -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Instagram</label>
              <input ng-model="empresa.instagram" name="instagram" type="text">
              <div ng-messages="editarEmpresaForm.instagram.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>

            <!-- Facebook -->
            <md-input-container class="md-icon-float md-block" flex="50">
              <label>Facebook</label>
              <input ng-model="empresa.facebook" name="facebook" type="text">
              <div ng-messages="editarEmpresaForm.facebook.$error" role="alert">
                <div ng-messages-include="messages.html"></div>
              </div>
            </md-input-container>
          </div>
        </fieldset>

        <fieldset>
          <legend>Parcerias</legend>
          <!-- Delivery -->
          <md-input-container class="md-block">
              <md-checkbox ng-model="empresa.isPrefeitura" aria-label="Surgiu de uma parceria com uma Prefeitura?">
                  As informações básicas da Empresa foi originada de uma parceria com uma Prefeitura: <b>{{empresa.isPrefeitura| yesNo}}</b>.
              </md-checkbox>
          </md-input-container>
        </fieldset>

        <fieldset>
          <legend>Configuração de Sistema</legend>
          <!-- Delivery -->
          <md-input-container class="md-block">
              <md-checkbox ng-model="empresa.isVisivel" aria-label="A empresas será exibida na listagem e busca para o visitante?">
                  A empresa será exibida na listagem e busca para o visitante: <b>{{empresa.isVisivel| yesNo}}</b>.
              </md-checkbox>
          </md-input-container>
        </fieldset>
      </form>
    </md-card-content>
  </md-card>

  <!-- Produtos da Empresa -->
  <md-card>
      <md-card-content layout="column">
          <!-- Adição e remoção de Produtos -->
          <md-tabs md-dynamic-height md-border-bottom>
              <!-- Produtos - Tab 1 -->
              <md-tab label="Produtos Vigentes">
                  <md-card>
                      <md-card-header>
                          <md-card-avatar>
                              <ng-md-icon icon="list" size="36"></ng-md-icon>
                          </md-card-avatar>

                          <md-card-header-text>
                              <span class="md-title">Gerenciar Produtos Vigentes</span>
                              <span class="md-subhead">Selecione o(s) Produto(s) para Remover ou Adicione um novo.</span>
                          </md-card-header-text>

                          <md-card-actions layout="row">
                              <md-card-icon-actions>

                                  <md-button class="md-icon-button" aria-label="Apagar Produto" ng-click="removerProduto(selectedProduto)">
                                      <md-tooltip md-direction="bottom">Apagar Produto</md-tooltip>
                                      <ng-md-icon icon="delete" size="24"></ng-md-icon>
                                  </md-button>

                                  <md-button class="md-icon-button" aria-label="Adicionar Produto" ng-click="adicionarProduto()">
                                      <md-tooltip md-direction="bottom">Adicionar Produto</md-tooltip>
                                      <ng-md-icon icon="add" size="24"></ng-md-icon>
                                  </md-button>

                              </md-card-icon-actions>
                          </md-card-actions>
                      </md-card-header>
                      <md-table-container>
                          <table md-table md-row-select multiple ng-model="selectedDiasRefeicao">
                              <thead md-head>
                                  <tr md-row>
                                      <th md-column>Nome do Produto</th>
                                      <th md-column>Descrição</th>
                                      <th md-column>Preço</th>
                                  </tr>
                              </thead>
                              <tbody md-body>
                                  <tr md-row md-select="produtos.id" md-select-id="produtos.id" md-auto-select ng-repeat="produto in produtos">
                                      <td md-cell>{{produto.nome | uppercase}}</td>
                                      <td md-cell>{{produto.descricao | uppercase}}</td>
                                      <td md-cell>{{produto.preco | uppercase}}</td>
                                  </tr>
                              </tbody>
                          </table>
                      </md-table-container>
                  </md-card>
              </md-tab>

              <!-- Histórico dos dias de refeição - Tab 2 -->
              <md-tab label="Histórico dos Produtos">
                  <md-card>
                      <md-card-header>

                          <md-card-header-text>
                              <span class="md-title">Histórico dos Produtos</span>
                              <span class="md-subhead">O histórico exibe todos os Produtos já atribuídos a Empresa (vigentes e removidos.)</span>
                          </md-card-header-text>

                          <md-card-actions layout="row">
                              <md-card-icon-actions>
                              </md-card-icon-actions>
                          </md-card-actions>
                      </md-card-header>

                      <md-table-container>
                          <table md-table>
                              <thead md-head>
                                  <tr md-row>
                                      <th md-column>Produto</th>
                                      <th md-column>Descrição</th>
                                      <th md-column>Preço</th>
                                  </tr>
                              </thead>
                              <tbody md-body>
                                  <tr md-row md-select="diaRefeicao" md-select-id="id" md-auto-select ng-repeat="diaRefeicaoTotal in diasRefeicaoTotais">
                                      <td md-cell>
                                          {{produto.nome | uppercase}}</td>
                                      <td md-cell>
                                          {{produto.descricao | uppercase}}</td>
                                      <td md-cell>
                                          {{produto.preco | uppercase}}</td>

                                      <td md-cell>
                                          <md-button aria-label="Refeições Realizadas" ui-sref="administrador.listar-refeicoesrealizadas-diarefeicao({idDiaRefeicao: diaRefeicaoTotal.id})" ui-sref-opts="{reload: true}">
                                              <ng-md-icon icon="list" size="18"></ng-md-icon>
                                              <md-tooltip md-direction="bottom">
                                                  Listar Refeições Realizadas
                                              </md-tooltip>
                                          </md-button>
                                      </td>
                                  </tr>
                              </tbody>
                          </table>
                      </md-table-container>
                  </md-card>
              </md-tab>

          </md-tabs>
      </md-card-content>
  </md-card>
</md-content>
